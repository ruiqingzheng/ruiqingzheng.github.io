<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ECS 下安装docker | 工作笔记</title>
    <meta name="description" content="Hendry的博客">
    <link rel="icon" href="/img/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.eecf6a6a.css" as="style"><link rel="preload" href="/assets/js/app.f8bee57c.js" as="script"><link rel="preload" href="/assets/js/13.e2503408.js" as="script"><link rel="prefetch" href="/assets/js/10.837bbfd0.js"><link rel="prefetch" href="/assets/js/11.bbd08110.js"><link rel="prefetch" href="/assets/js/12.eb514b46.js"><link rel="prefetch" href="/assets/js/14.d97c0ac2.js"><link rel="prefetch" href="/assets/js/15.baf7986f.js"><link rel="prefetch" href="/assets/js/16.2b12bf6f.js"><link rel="prefetch" href="/assets/js/17.f7e545ac.js"><link rel="prefetch" href="/assets/js/18.70d9230d.js"><link rel="prefetch" href="/assets/js/19.0a61e7ba.js"><link rel="prefetch" href="/assets/js/2.d139c70a.js"><link rel="prefetch" href="/assets/js/20.87141f48.js"><link rel="prefetch" href="/assets/js/21.536e6d3b.js"><link rel="prefetch" href="/assets/js/22.fa3e648a.js"><link rel="prefetch" href="/assets/js/23.f6c367b9.js"><link rel="prefetch" href="/assets/js/24.a8f770f5.js"><link rel="prefetch" href="/assets/js/25.3bb8bbfc.js"><link rel="prefetch" href="/assets/js/26.1c16cfb8.js"><link rel="prefetch" href="/assets/js/27.075df559.js"><link rel="prefetch" href="/assets/js/28.90c1e366.js"><link rel="prefetch" href="/assets/js/29.3145e78e.js"><link rel="prefetch" href="/assets/js/3.de89ea98.js"><link rel="prefetch" href="/assets/js/30.9832e5bd.js"><link rel="prefetch" href="/assets/js/31.2f9a7c5b.js"><link rel="prefetch" href="/assets/js/32.df9181b5.js"><link rel="prefetch" href="/assets/js/33.ec53f96d.js"><link rel="prefetch" href="/assets/js/34.398a7128.js"><link rel="prefetch" href="/assets/js/35.bb1c5a48.js"><link rel="prefetch" href="/assets/js/36.935a5449.js"><link rel="prefetch" href="/assets/js/37.459fef35.js"><link rel="prefetch" href="/assets/js/38.f51023c1.js"><link rel="prefetch" href="/assets/js/39.ed9f7023.js"><link rel="prefetch" href="/assets/js/4.a889cc83.js"><link rel="prefetch" href="/assets/js/40.7959ecc5.js"><link rel="prefetch" href="/assets/js/41.2f350c5b.js"><link rel="prefetch" href="/assets/js/42.3a09f5a5.js"><link rel="prefetch" href="/assets/js/43.b22e3395.js"><link rel="prefetch" href="/assets/js/44.ea91f873.js"><link rel="prefetch" href="/assets/js/45.29363c9f.js"><link rel="prefetch" href="/assets/js/46.45848afe.js"><link rel="prefetch" href="/assets/js/47.309f8db5.js"><link rel="prefetch" href="/assets/js/48.4da217ee.js"><link rel="prefetch" href="/assets/js/49.713e67fd.js"><link rel="prefetch" href="/assets/js/5.7183a5fb.js"><link rel="prefetch" href="/assets/js/50.d90574c6.js"><link rel="prefetch" href="/assets/js/51.5190cc6c.js"><link rel="prefetch" href="/assets/js/52.25c37497.js"><link rel="prefetch" href="/assets/js/53.3fea90a3.js"><link rel="prefetch" href="/assets/js/54.d23ad054.js"><link rel="prefetch" href="/assets/js/55.d8ba3a31.js"><link rel="prefetch" href="/assets/js/56.bc578093.js"><link rel="prefetch" href="/assets/js/57.cb8c611e.js"><link rel="prefetch" href="/assets/js/58.4a6efece.js"><link rel="prefetch" href="/assets/js/59.397f12f2.js"><link rel="prefetch" href="/assets/js/6.6621a9ba.js"><link rel="prefetch" href="/assets/js/60.a209bb60.js"><link rel="prefetch" href="/assets/js/61.0a1b1f3b.js"><link rel="prefetch" href="/assets/js/62.a79409e9.js"><link rel="prefetch" href="/assets/js/63.f99fda12.js"><link rel="prefetch" href="/assets/js/64.59a96a9c.js"><link rel="prefetch" href="/assets/js/65.ab4be186.js"><link rel="prefetch" href="/assets/js/66.df4455cd.js"><link rel="prefetch" href="/assets/js/7.a024304b.js"><link rel="prefetch" href="/assets/js/8.be16c405.js"><link rel="prefetch" href="/assets/js/9.37e77487.js">
    <link rel="stylesheet" href="/assets/css/0.styles.eecf6a6a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">工作笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/menu.html" class="nav-link">首页</a></div><div class="nav-item"><a href="/Android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/直播/" class="nav-link">直播</a></div><div class="nav-item"><a href="/前端/" class="nav-link">前端</a></div><div class="nav-item"><a href="/公众号/" class="nav-link">公众号</a></div><div class="nav-item"><a href="/项目/" class="nav-link">项目</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">冒泡</a></li><li class="dropdown-subitem"><a href="/language/japanese.html" class="nav-link">快速</a></li></ul></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">工厂</a></li><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">单例</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/menu.html" class="nav-link">首页</a></div><div class="nav-item"><a href="/Android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/直播/" class="nav-link">直播</a></div><div class="nav-item"><a href="/前端/" class="nav-link">前端</a></div><div class="nav-item"><a href="/公众号/" class="nav-link">公众号</a></div><div class="nav-item"><a href="/项目/" class="nav-link">项目</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">冒泡</a></li><li class="dropdown-subitem"><a href="/language/japanese.html" class="nav-link">快速</a></li></ul></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">工厂</a></li><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">单例</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>ECS 下安装docker</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/%E5%85%B6%E4%BB%96/docker.html#运行hello-world-镜像" class="sidebar-link">运行hello-world 镜像</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%85%B6%E4%BB%96/docker.html#运行nginx镜像" class="sidebar-link">运行nginx镜像</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%85%B6%E4%BB%96/docker.html#运行容器排错" class="sidebar-link">运行容器排错</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p>8ecs 主机提示目前运行的phpmyadmin提示有漏洞</p> <p>尝试换成docker来跑phpmyadmin</p> <h1 id="ecs-下安装docker"><a href="#ecs-下安装docker" aria-hidden="true" class="header-anchor">#</a> ECS 下安装docker</h1> <p>Docker要求Lunix内核版本至少是3.10</p> <p>而centos6.8 内核不符合要求</p> <div class="language-s extra-class"><pre class="language-text"><code># uname -r
2.6.32-642.13.1.el6.x86_64
</code></pre></div><p>看来必须使用centos7.2 或者ubuntu , 考虑到centos更稳定, 将实例镜像还是用centos7.2 64位 内核版本 <code>3.10.0-514.6.2.el7.x86_64</code></p> <h1 id="安装dockser"><a href="#安装dockser" aria-hidden="true" class="header-anchor">#</a> 安装dockser</h1> <p>ecs centos7.2 下默认阿里源直接安装
<code>yum install docker</code></p> <p>启动docker服务
<code>service docker start</code></p> <p>docker pull name:tag  获取镜像:版本
docker images 查看本机有哪些镜像</p> <p>docker 每次默认都要去访问官方镜像仓库<code>docker.io</code> 还好目前没有被墙  <code>hub.docker.com</code></p> <p>拉取示例镜像<code>hello-world</code> <code>docker pull hello-world</code></p> <h2 id="运行hello-world-镜像"><a href="#运行hello-world-镜像" aria-hidden="true" class="header-anchor">#</a> 运行hello-world 镜像</h2> <p>运行docker镜像 -- docker容器</p> <p><code>docker run [opt] image:tag [command] [arg]</code></p> <p>运行一个镜像, 后面可以跟命令, 进行运行起来后执行该命令和arg参数...</p> <p><code>docker run hello-world</code></p> <p>该命令的执行过程</p> <ol><li>docker client 连接到docker服务</li> <li>docker服务拉取镜像 ,把镜像从网络拉取到本地 (docker hub 就是 docker仓库)</li> <li>创建新容器来运行程序, 程序运行生成输出</li> <li>docker服务将容器中生成的输出流传输给docker client, docker client 输出到终端</li></ol> <h2 id="运行nginx镜像"><a href="#运行nginx镜像" aria-hidden="true" class="header-anchor">#</a> 运行nginx镜像</h2> <p>hello-world是前台运行, 运行完毕即退出
而nginx需要持久运行, 需要后台运行 , 于是它是个持久运行的容器</p> <p>进入容器内部</p> <ol><li><p>拉镜像 <code>https://c.163.com/</code> 镜像中心, 搜nginx , 鲸鱼标记表示 docker官网镜像
<code>docker pull hub.c.163.com/library/nginx:latest</code></p></li> <li><p>容器中运行镜像
<code>docker run hub.c.163.com/library/nginx</code>   //这种是前台方式运行
<code>docker ps</code>     //在另外一个终端查看,   查看当前再运行的容器, 可见容器在运行
//在前台运行的容器, CTRL + C 可以终止</p></li></ol> <p>后台运行nginx 才是正确的运行方法 <code>-d 后台运行, 且打印容器ID</code></p> <div class="language-s extra-class"><pre class="language-text"><code># docker run -d hub.c.163.com/library/nginx
074c16d50efdc25b4eb4dff8b9323c7c7ba5c024b6c57f2b7f59c1a370411504
</code></pre></div><ol start="3"><li>进入到容器</li></ol> <p>docker exec 在一个运行的指定ID容器中运行命令</p> <p>参数:</p> <p>-i 输入模式, 即使容器是前台阻塞模式 , 也能输入
-t 分配控制台</p> <p><code>docker exec -it 074c16d5 bash</code></p> <p><code>which nginx</code>  //查看nginx命令位置
<code>ps -ef</code>    //可见nginx pid 为1,  worker进程也都很小</p> <p><code>docker attach myadmin</code> //连接到该容器, 交互方式启动的容器才能attach
//attach 相当于是给容器在运行的环境中加入一个终端, 让我们进行操作
//而交互方式启动的容器本身就有终端, attach 就是让我们能使用这个终端
//如果是后台方式启动的容器, 本身环境中就是没有终端的, attach也就不起作用了
//后台启动方式的话, 使用-it参数 , 然后运行<code>sh</code> 就能连接,  因为几乎所有的容器内部还是linux环境 都有sh, 所以这个连接到容器的方法最通用
//但attach 是连接到容器的程序运行的shell ,  exec 是一个新的shell
<code>docker exec -it myadmin sh</code></p> <ol start="4"><li><p>停止容器
<code>docker stop 074c16d5</code></p></li> <li><p>访问docker网络</p></li></ol> <p>bridge模式: 独立网络模式 , 容器内有自己的ip和端口, 访问时需要将容器内的端口和主机端口进行映射才能访问</p> <p>host模式: 使用宿主机的网络, 容器直接使用主机的网卡</p> <p>none: 无网络模式</p> <p>比如这个例子中的nginx 镜像的容器服务端口是80
<code>docker --help</code> <code>-p --publish list</code> 开放端口到主机, 主机端口:容器端口
<code>-P</code> 开放本机的随机端口分别 映射到容器的每个服务端口</p> <p><code>docker run -d -p 8080:80 hub.c.163.com/library/nginx</code></p> <p>主机的8080端口映射为容器的80端口,访问<code>http://db-bak.router:8080/</code></p> <p><code>docker run -d -P hub.c.163.com/library/nginx</code></p> <p>随机端口映射<code>0.0.0.0:32768-&gt;80/tcp</code></p> <hr> <h1 id="制作自己的镜像"><a href="#制作自己的镜像" aria-hidden="true" class="header-anchor">#</a> 制作自己的镜像</h1> <p>dockerfile  制作镜像的文件</p> <p>docker build  执行docker file中的动作</p> <p>以为例 <code>press</code> 框架为例 , jpress 是一个java语言编写的类似wordpress的博客系统 , 整个应用就是一个war文件包
需要tomcat环境</p> <ol><li>下载jpress, 下载基础镜像</li></ol> <p>创建目录 <code>demo-jpress</code> , 制作镜像的操作都在该目录下进行</p> <p><code>wget https://github.com/JpressProjects/jpress/blob/master/wars/jpress-web-newest.war</code></p> <p>c.163.com 找基础镜像, tomcat , tomcat是依赖jdk的, 所以这个镜像里面肯定是包括jdk的, 这个镜像有300度M</p> <p><code>docker pull hub.c.163.com/library/tomcat:latest</code></p> <ol start="2"><li>Dockerfile</li></ol> <p>基础镜像, 将jpress应用拷贝到对应目录,  这个目录我们要在镜像下载页面中找说明文档, 确定地址</p> <blockquote><p><code>Dockerfile</code></p></blockquote> <div class="language-s extra-class"><pre class="language-text"><code>from hub.c.163.com/library/tomcat
MAINTAINER hendry xxx@163.com
COPY jpress.war /usr/local/tomcat/webapps
</code></pre></div><ol start="3"><li>docker build .</li></ol> <p><code>docker build .</code> //点表示Dockerfile存放目录</p> <p>命令运行时会列出每一步详细信息,
成功后用<code>docker images</code> 查看一下 , 没有名字, 只有image id</p> <p>给镜像指定名字和tag
<code>docker build -t jpress:latest .</code></p> <ol start="4"><li>运行自定义镜像
还是要先去tomcat镜像下载页面查看默认服务端口 , 8080</li></ol> <p>运行时进行映射</p> <p><code>docker run -d -p 8080:8080 jpress</code></p> <p>这样更方便查看错误消息
<code>docker run -it --rm -p 8888:8080 jpress</code>   //但这样运行后, 容器就被删除, 方便调试</p> <p><code>docker run -it --name jpress -p 88:8080 jpress</code>  // 去掉 --rm , --name 指定容器名称, 方便以后重新启动该容器</p> <p>下次启动 <code>docker start jpress</code></p> <h1 id="删除镜像"><a href="#删除镜像" aria-hidden="true" class="header-anchor">#</a> 删除镜像</h1> <p><code>docker rmi a8</code>
提示错误 , 这个镜像有容器使用,  且列出了容器id, 那么
要先删除该容器
<code>docker rm 246b2feae8cb</code> 然后再次运行上面的删除镜像命令</p> <h1 id="mysql-镜像"><a href="#mysql-镜像" aria-hidden="true" class="header-anchor">#</a> mysql 镜像</h1> <p>docker pull mysql</p> <p>镜像的页面查看怎么传参启动</p> <p><code>docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag</code></p> <p>-e 指定环境变量, 不同的镜像, 不同的参数
--name some-mysql  是给容器取名字 , 方便其他的容器来连接 , 这里测试就不指定这个参数了
-e MYSQL_DATABASE=jpress , 在启动的时候创建该数据库</p> <p>docker run -d -e MYSQL_ROOT_PASSWORD=000000 -e MYSQL_DATABASE=jpress -p 3306:3306 mysql</p> <p><code>http://db-bak.router:8080/jpress/install/step2</code>
jpress 安装的时候提示数据库主机 , 因为容器是独立于主机无法直接访问 , 要通过主机ip的3306端口才能访问 <code>172.19.174.164</code></p> <p><code>docker restart 38c948800818</code></p> <h1 id="phpmyadmin"><a href="#phpmyadmin" aria-hidden="true" class="header-anchor">#</a> phpmyadmin</h1> <p><code>docker pull phpmyadmin/phpmyadmin</code>   //从hub.docker.com下载 , phpmyadmin 官方镜像</p> <p>//启动数据库
docker run --name test-db-server -e MYSQL_ROOT_PASSWORD=000000 -e MYSQL_DATABASE=jpress -p 3306:3306 -d mysql</p> <p>//如果phpmyadmin 和 数据库在同一个容器内运行的话 , 可以指定--link mysql_db_server:db 来指定数据库服务器, 但是我们这里是在不同的容器里
// 因此 相对phpmyadmin来说数据库属于  <code>external server</code> ,    本机上的不同的容器之间可以使用本地ip来进行访问, 比如 <code>192.168.0.2</code>
// 但不能是127.0.0.1 或 localhost 因为他们表示的容器本身地址 , 容器之间通讯就好像是在一个局域网内, 用内网地址</p> <p><code>docker run --name myadmin -it --rm -e PMA_HOST=172.19.174.164 -p 3307:80 phpmyadmin/phpmyadmin</code></p> <p>这样当我们访问3307 端口就能访问到phpmyadmin 对数据库的操作</p> <h1 id="重新启动已有的容器"><a href="#重新启动已有的容器" aria-hidden="true" class="header-anchor">#</a> 重新启动已有的容器</h1> <p>在Docker中重新启动已经停止的容器</p> <p><code>docker ps -a</code> //查看容器列表,包括停止的容器
<code>docker start myadmin</code>  //启动前面命名为myadmin的容器
<code>docker attach myadmin</code> //连接到该容器, 交互方式启动的容器才能attach
//attach 相当于是给容器在运行的环境中加入一个终端, 让我们进行操作
//而交互方式启动的容器本身就有终端, attach 就是让我们能使用这个终端
//如果是后台方式启动的容器, 本身环境中就是没有终端的, attach也就不起作用了
//后台启动方式的话, 使用-it参数 , 然后运行<code>sh</code> 就能连接,  因为几乎所有的容器内部还是linux环境 都有sh, 所以这个连接到容器的方法最通用
//但attach 是连接到容器的程序运行的shell ,  exec 是一个新的shell
<code>docker exec -it myadmin sh</code></p> <h1 id="运行镜像"><a href="#运行镜像" aria-hidden="true" class="header-anchor">#</a> 运行镜像</h1> <p>运行已有的容器, 命令是   <code>docker start 容器名</code> 或 <code>docker restart 容器名</code></p> <p>运行镜像, 命令
<code>docker run [参数] imageName [命令 [命令参数]]</code></p> <p>常用的参数有</p> <p>--rm // 运行镜像后,  删除容器
-it // -i 输入模式, 即使容器是前台阻塞模式 , 也能输入 ; -t 分配控制台
-p  // 端口映射  主机端口:容器内端口
-d  // 后台运行
--name  // 指定容器名字</p> <p>且后面还能指定容器启动后运行什么命令</p> <p>对于有的应用, 不需要看日志, 程序本身也不会对文件进行修改的, 比如phpmyadmin ,</p> <p>调试的时候就用 <code>docker run -it --rm</code> , 就是说这样的容器不需要保存, 退出就删除</p> <p>调试完毕, 如果没有问题的话, 就放到后台运行 , 且给容器命名 那么就用参数 <code>docker run --name myadmin -d</code></p> <p>给容器命名的目的有两个</p> <ol><li>方便以后再次用相同的命令来启动该容器</li> <li>容器名可提供给其他程序使用</li></ol> <p>是否后台运行</p> <ol><li>调试的时候 肯定是不会后台运行的 , 调试 <code>-it --rm</code></li> <li>有的应用, 如果要实时查看日志 也不要后台运行</li></ol> <p>另外如果应用需要修改本地文件,  那么就要记得给容器命名, 且不要用 --rm 参数</p> <h1 id="aliyun-ecs-上使用docker"><a href="#aliyun-ecs-上使用docker" aria-hidden="true" class="header-anchor">#</a> aliyun ECS 上使用docker</h1> <p>ECS centos 7.2 64位  内核低了的话 无法装docker</p> <p>另外如果使用yum 安装的话, docker版本比较低 ,</p> <p>所以, 如果已有docker先卸载</p> <p><code>yum erase docker docker-client docker-common</code></p> <p>安装docker</p> <p><code>curl -sSL http://acs-public-mirror.oss-cn-hangzhou.aliyuncs.com/docker-engine/internet | sh -</code></p> <p>阿里docker主页:  <code>https://dev.aliyun.com/search.html</code></p> <p>使用阿里云Docker镜像加速:
http://warjiang.github.io/devcat/2016/11/28/%E4%BD%BF%E7%94%A8%E9%98%BF%E9%87%8C%E4%BA%91Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/</p> <p>如何使用Docker加速器, centos 7 , 其他版本见阿里docker加速器后台<code>https://cr.console.aliyun.com/?spm=5176.100239.blogcont29941.13.czCHyc#/accelerator</code></p> <p>登陆阿里docker加速器后台后, 会分配一个加速地址, 比如<code>https://3n5cxm7b.mirror.aliyuncs.com</code> 这个是系统分配的加速地址, 每个用户不同</p> <p>您可以通过修改daemon配置文件<code>/etc/docker/daemon.json</code>来使用加速器：</p> <div class="language-s extra-class"><pre class="language-text"><code>sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'
{
  &quot;registry-mirrors&quot;: [&quot;https://3n5cxm7b.mirror.aliyuncs.com&quot;]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre></div><h1 id="使用阿里镜像"><a href="#使用阿里镜像" aria-hidden="true" class="header-anchor">#</a> 使用阿里镜像</h1> <p><code>https://help.aliyun.com/knowledge_detail/52225.html</code></p> <p>docker 就是为了提供一致的环境, 但我们可以把已经配置好的硬盘做成镜像,  然后其他的ECS主机直接使用我们已经保存的镜像即可</p> <p>有了这样的镜像, 那么docker镜像其实就没有什么意义了 ? 因为我们可以在一台机器上配置 , 然后把镜像分发下去</p> <p>我们可以把docker + 阿里镜像结合起来使用</p> <h1 id="faq"><a href="#faq" aria-hidden="true" class="header-anchor">#</a> FAQ</h1> <h2 id="运行容器排错"><a href="#运行容器排错" aria-hidden="true" class="header-anchor">#</a> 运行容器排错</h2> <p>在上面的demo-jpress中 , 遇到错误<code>java.lang.IllegalArgumentException: java.util.zip.ZipException: error in opening zip file</code></p> <p>提示zip解压错误, 踩坑不少: 开始的时候以为是环境的问题, 于是从163的docker源换到阿里的docker源, 从阿里源下载下来的tomcat 镜像确定是官方镜像</p> <p>但依然是这个错误, 后来才看到有少数人也遇到过这样的问题, 最后找到原因是<code>war</code>文件不完整.  结果比对了github上的文件大小和我们实际的文件大小, 果然就是这个原因.</p> <p>结果从香港vps上下载这个war文件然后scp到测试的docker机器上, 问题解决..</p> <p>看来以后从github上下载一定要注意文件是否完整, 当前的网络封锁的各种问题都出来了</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.f8bee57c.js" defer></script><script src="/assets/js/13.e2503408.js" defer></script>
  </body>
</html>
