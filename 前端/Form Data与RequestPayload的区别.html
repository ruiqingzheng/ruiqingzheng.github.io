<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTP 请求中的 Form Data 与 Request Payload 的区别 | 工作笔记</title>
    <meta name="description" content="Hendry的博客">
    <link rel="icon" href="/img/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.eecf6a6a.css" as="style"><link rel="preload" href="/assets/js/app.f8bee57c.js" as="script"><link rel="preload" href="/assets/js/16.2b12bf6f.js" as="script"><link rel="prefetch" href="/assets/js/10.837bbfd0.js"><link rel="prefetch" href="/assets/js/11.bbd08110.js"><link rel="prefetch" href="/assets/js/12.eb514b46.js"><link rel="prefetch" href="/assets/js/13.e2503408.js"><link rel="prefetch" href="/assets/js/14.d97c0ac2.js"><link rel="prefetch" href="/assets/js/15.baf7986f.js"><link rel="prefetch" href="/assets/js/17.f7e545ac.js"><link rel="prefetch" href="/assets/js/18.70d9230d.js"><link rel="prefetch" href="/assets/js/19.0a61e7ba.js"><link rel="prefetch" href="/assets/js/2.d139c70a.js"><link rel="prefetch" href="/assets/js/20.87141f48.js"><link rel="prefetch" href="/assets/js/21.536e6d3b.js"><link rel="prefetch" href="/assets/js/22.fa3e648a.js"><link rel="prefetch" href="/assets/js/23.f6c367b9.js"><link rel="prefetch" href="/assets/js/24.a8f770f5.js"><link rel="prefetch" href="/assets/js/25.3bb8bbfc.js"><link rel="prefetch" href="/assets/js/26.1c16cfb8.js"><link rel="prefetch" href="/assets/js/27.075df559.js"><link rel="prefetch" href="/assets/js/28.90c1e366.js"><link rel="prefetch" href="/assets/js/29.3145e78e.js"><link rel="prefetch" href="/assets/js/3.de89ea98.js"><link rel="prefetch" href="/assets/js/30.9832e5bd.js"><link rel="prefetch" href="/assets/js/31.2f9a7c5b.js"><link rel="prefetch" href="/assets/js/32.df9181b5.js"><link rel="prefetch" href="/assets/js/33.ec53f96d.js"><link rel="prefetch" href="/assets/js/34.398a7128.js"><link rel="prefetch" href="/assets/js/35.bb1c5a48.js"><link rel="prefetch" href="/assets/js/36.935a5449.js"><link rel="prefetch" href="/assets/js/37.459fef35.js"><link rel="prefetch" href="/assets/js/38.f51023c1.js"><link rel="prefetch" href="/assets/js/39.ed9f7023.js"><link rel="prefetch" href="/assets/js/4.a889cc83.js"><link rel="prefetch" href="/assets/js/40.7959ecc5.js"><link rel="prefetch" href="/assets/js/41.2f350c5b.js"><link rel="prefetch" href="/assets/js/42.3a09f5a5.js"><link rel="prefetch" href="/assets/js/43.b22e3395.js"><link rel="prefetch" href="/assets/js/44.ea91f873.js"><link rel="prefetch" href="/assets/js/45.29363c9f.js"><link rel="prefetch" href="/assets/js/46.45848afe.js"><link rel="prefetch" href="/assets/js/47.309f8db5.js"><link rel="prefetch" href="/assets/js/48.4da217ee.js"><link rel="prefetch" href="/assets/js/49.713e67fd.js"><link rel="prefetch" href="/assets/js/5.7183a5fb.js"><link rel="prefetch" href="/assets/js/50.d90574c6.js"><link rel="prefetch" href="/assets/js/51.5190cc6c.js"><link rel="prefetch" href="/assets/js/52.25c37497.js"><link rel="prefetch" href="/assets/js/53.3fea90a3.js"><link rel="prefetch" href="/assets/js/54.d23ad054.js"><link rel="prefetch" href="/assets/js/55.d8ba3a31.js"><link rel="prefetch" href="/assets/js/56.bc578093.js"><link rel="prefetch" href="/assets/js/57.cb8c611e.js"><link rel="prefetch" href="/assets/js/58.4a6efece.js"><link rel="prefetch" href="/assets/js/59.397f12f2.js"><link rel="prefetch" href="/assets/js/6.6621a9ba.js"><link rel="prefetch" href="/assets/js/60.a209bb60.js"><link rel="prefetch" href="/assets/js/61.0a1b1f3b.js"><link rel="prefetch" href="/assets/js/62.a79409e9.js"><link rel="prefetch" href="/assets/js/63.f99fda12.js"><link rel="prefetch" href="/assets/js/64.59a96a9c.js"><link rel="prefetch" href="/assets/js/65.ab4be186.js"><link rel="prefetch" href="/assets/js/66.df4455cd.js"><link rel="prefetch" href="/assets/js/7.a024304b.js"><link rel="prefetch" href="/assets/js/8.be16c405.js"><link rel="prefetch" href="/assets/js/9.37e77487.js">
    <link rel="stylesheet" href="/assets/css/0.styles.eecf6a6a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">工作笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/menu.html" class="nav-link">首页</a></div><div class="nav-item"><a href="/Android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/直播/" class="nav-link">直播</a></div><div class="nav-item"><a href="/前端/" class="nav-link">前端</a></div><div class="nav-item"><a href="/公众号/" class="nav-link">公众号</a></div><div class="nav-item"><a href="/项目/" class="nav-link">项目</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">冒泡</a></li><li class="dropdown-subitem"><a href="/language/japanese.html" class="nav-link">快速</a></li></ul></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">工厂</a></li><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">单例</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/menu.html" class="nav-link">首页</a></div><div class="nav-item"><a href="/Android/" class="nav-link">Android</a></div><div class="nav-item"><a href="/直播/" class="nav-link">直播</a></div><div class="nav-item"><a href="/前端/" class="nav-link">前端</a></div><div class="nav-item"><a href="/公众号/" class="nav-link">公众号</a></div><div class="nav-item"><a href="/项目/" class="nav-link">项目</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">高级</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">冒泡</a></li><li class="dropdown-subitem"><a href="/language/japanese.html" class="nav-link">快速</a></li></ul></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">工厂</a></li><li class="dropdown-subitem"><a href="/language/chinese.html" class="nav-link">单例</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>HTTP 请求中的 Form Data 与 Request Payload 的区别</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/%E5%89%8D%E7%AB%AF/Form%20Data%E4%B8%8ERequestPayload%E7%9A%84%E5%8C%BA%E5%88%AB.html#方式一：-form-data-形式" class="sidebar-link">方式一： Form Data 形式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/Form%20Data%E4%B8%8ERequestPayload%E7%9A%84%E5%8C%BA%E5%88%AB.html#方式二：request-payload-形式" class="sidebar-link">方式二：Request Payload 形式</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="http-请求中的-form-data-与-request-payload-的区别"><a href="#http-请求中的-form-data-与-request-payload-的区别" aria-hidden="true" class="header-anchor">#</a> HTTP 请求中的 Form Data 与 Request Payload 的区别</h1> <p>参考</p> <p>https://www.cnblogs.com/Abner5/p/7559851.html</p> <p>https://my.oschina.net/zimingforever/blog/737414</p> <p>前端开发中经常会用到 AJAX 发送异步请求，对于 POST 类型的请求会附带请求数据。而常用的两种传参方式为：Form Data 和 Request Payload。</p> <p><img src="https://images2017.cnblogs.com/blog/1018462/201709/1018462-20170920093039978-2100563214.png" alt="img"></p> <p><img src="https://images2017.cnblogs.com/blog/1018462/201709/1018462-20170920093047056-655827777.png" alt="img"></p> <h1 id="get-请求"><a href="#get-请求" aria-hidden="true" class="header-anchor">#</a> GET 请求</h1> <p>使用 get 请求时，参数会以 key=value 的形式拼接在请求的 url 后面。例如：</p> <div class="language- extra-class"><pre class="language-text"><code>`http://m.baidu.com/address/getlist.html?limit=50&amp;offset=0&amp;t=1502345139870`
</code></pre></div><p>但是受限于请求 URL 的长度限制，一般参数较少时会使用 get 请求。</p> <h1 id="post-请求"><a href="#post-请求" aria-hidden="true" class="header-anchor">#</a> POST 请求</h1> <p>当参数数量较多，且对数据有一定安全性要求时，会考虑用 post 请求传递参数数据。POST 请求的参数数据是在请求体中。</p> <h2 id="方式一：-form-data-形式"><a href="#方式一：-form-data-形式" aria-hidden="true" class="header-anchor">#</a> 方式一： Form Data 形式</h2> <p>当 POST 请求的请求头里设置 Content-Type: application/x-www-form-urlencoded(默认), 参数在请求体以标准的 Form Data 的形式提交，以&amp;符号拼接，参数格式为 key=value&amp;key=value&amp;key=value...</p> <p><img src="https://images2017.cnblogs.com/blog/1018462/201709/1018462-20170920093132150-1553778311.png" alt="img"></p> <p>前端代码设置：</p> <p>xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded'); xhr.send('a=1&amp;b=2&amp;c=3');</p> <p>在 servlet 中，后端可以通过 request.getParameter(name)的形式来获取表单参数。</p> <h2 id="方式二：request-payload-形式"><a href="#方式二：request-payload-形式" aria-hidden="true" class="header-anchor">#</a> 方式二：Request Payload 形式</h2> <p>如果使用 AJAX 原生 POST 请求,请求头里设置 Content-Type:application/json，请求的参数会显示在 Request Payload 中，参数格式为 JSON 格式：{&quot;key&quot;:&quot;value&quot;,&quot;key&quot;:&quot;value&quot;...}，这种方式可读性会更好。</p> <p><img src="https://images2017.cnblogs.com/blog/1018462/201709/1018462-20170920093208759-1131445967.png" alt="img"></p> <p>后端可以使用 getRequestPayload 方法来获取。</p> <h1 id="form-data-和-request-payload-区别"><a href="#form-data-和-request-payload-区别" aria-hidden="true" class="header-anchor">#</a> Form Data 和 Request Payload 区别</h1> <ol><li>如果请求头里设置 Content-Type: application/x-www-form-urlencoded，那么这个请求被认为是表单请求，参数出现在 Form Data 里，格式为 key=value&amp;key=value&amp;key=value...</li> <li>原生的 AJAX 请求头里设置 Content-Type:application/json，或者使用默认的请求头 Content-Type:text/plain;参数会显示在 Request payload 块里提交。</li></ol> <p>formdata 和 requestpayload 到底有什么区别呢、为什么用 fecth 的时候，提交的数据都变成了 request payload？</p> <p>对于 get 请求，表单参数以 name=value&amp;name1=value1 的形式附到 url 的后面</p> <p>对于 post 请求，表单参数是在请求体中，也是以 name=value&amp;name1=value1 的形式在请求体中，并且 post 请求的 Content-Type 为 application/x-www-form-urlencoded，参数是在请求体中，即请求中的 Form Data。在 servlet 中，可以通过 request.getParameter(name)的形式来获取表单参数。</p> <p>但是如果是原生的 ajax 请求，请求的 Content-Type 为 text/plain;charset=UTF-8，而请求表单参数在 RequestPayload 中。此时的 POST 请求是不会读取请求体数据和进行相应的参数处理的，即不会解析表单数据来放到 request parameter map 中。所以通过 request.getParameter(name)是获取不到的。此时 servelet 中只能用解析流的解析</p> <p>为什么原生的 ajax 后者 fetch 不能获取 form data 呢？</p> <p>jquery 在执行 post 请求时，会设置 Content-Type 为 application/x-www-form-urlencoded，所以服务器能够正确解析，而使用原生 ajax 请求时，如果不显示的设置 Content-Type，那么默认是 text/plain，这时服务器就不知道怎么解析数据了，所以才只能通过获取原始数据流的方式来进行解析请求数据。</p> <p>解决方案是什么呢？可以再请求的时候增加</p> <p>\you have not provided enough information how you use the send function, but I assume that you do not set mime type to specify you are sending form data</p> <div class="language-js extra-class"><pre class="language-js"><code>xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span>
</code></pre></div><p>the data sent are in this case encoded as you encode a query string</p> <div class="language-js extra-class"><pre class="language-js"><code>xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'name=foo&amp;value=bar'</span><span class="token punctuation">)</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.f8bee57c.js" defer></script><script src="/assets/js/16.2b12bf6f.js" defer></script>
  </body>
</html>
