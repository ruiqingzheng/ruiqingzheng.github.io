(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{196:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("p",[t._v("例子: "),a("code",[t._v("Vue\\vux_hendry")])]),t._v(" "),a("h1",{attrs:{id:"什么时候出现滚动条"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么时候出现滚动条","aria-hidden":"true"}},[t._v("#")]),t._v(" 什么时候出现滚动条")]),t._v(" "),a("p",[t._v("当子元素的高度超过父元素的高度 , 那么父元素会出现滚动条\n需要定义样式 "),a("code",[t._v("overflow-y:auto;")])]),t._v(" "),a("p",[t._v("例子 :")]),t._v(" "),a("p",[t._v("mui 里面 , 页面结构是"),a("code",[t._v("mheader")]),t._v(" , "),a("code",[t._v("mbody")]),t._v(" "),a("code",[t._v("mheader")]),t._v(" 就是 mui-bar 样式类的"),a("code",[t._v("header")]),t._v(" "),a("code",[t._v("mbody")]),t._v(" 就是"),a("code",[t._v("mui-content")]),t._v(" 样式类的"),a("code",[t._v("div")])]),t._v(" "),a("p",[t._v("而我们要的滚动区域是放在"),a("code",[t._v("mui-content")]),t._v("里面")]),t._v(" "),a("p",[t._v("于是我们先把"),a("code",[t._v("mui-content")]),t._v(" 设置为绝对定位为左上角 , 且 mui 是对"),a("code",[t._v("mui-content")]),t._v(" 处理过的\n"),a("code",[t._v("mui-content")]),t._v(" 是会预留一定空白高度给"),a("code",[t._v("header")]),t._v("的, 于是即使定位 content 是左上角,\n"),a("code",[t._v("header")]),t._v("是重叠放在"),a("code",[t._v("content")]),t._v("之上的, 但是不会遮住"),a("code",[t._v("content")]),t._v("内容的")]),t._v(" "),a("p",[t._v("定位"),a("code",[t._v("mui-content")]),t._v("为"),a("code",[t._v("absolute")]),t._v(" , 然后对需要"),a("code",[t._v("滚动条")]),t._v("的容器设置"),a("code",[t._v("overflow-y:auto;")])]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".mui-content")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("background")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" #fff"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("position")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" absolute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("top")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("left")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("right")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("bottom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".mui-content > div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 100%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("overflow-y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h1",{attrs:{id:"滚动条父元素容器的-3-个属性-clientheight-scrollheight-scrolltop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#滚动条父元素容器的-3-个属性-clientheight-scrollheight-scrolltop","aria-hidden":"true"}},[t._v("#")]),t._v(" 滚动条父元素容器的 3 个属性 clientHeight , scrollHeight , scrollTop")]),t._v(" "),a("p",[a("code",[t._v("http://www.cnblogs.com/cheerful-queen/p/6382933.html")])]),t._v(" "),a("ol",[a("li",[t._v("可视高度"),a("code",[t._v("clientHeight")]),t._v(" 由容器"),a("code",[t._v("height")]),t._v("决定, 一般容器"),a("code",[t._v("height")]),t._v("定义为所有可用高度.")])]),t._v(" "),a("p",[t._v("这样该"),a("code",[t._v("div")]),t._v(" 下的内容只要高度超过, 父容器定义了"),a("code",[t._v("height:100%")])]),t._v(" "),a("p",[t._v("实际上是定义的可视区域 , 这个"),a("code",[t._v("height")]),t._v(" , 就确定了 "),a("code",[t._v("clientHeight")])]),t._v(" "),a("p",[a("code",[t._v("clientHeight")]),t._v(" = "),a("code",[t._v("CSS height")]),t._v(" + "),a("code",[t._v("CSS padding")]),t._v(" - "),a("code",[t._v("水平滚动条高度")])]),t._v(" "),a("p",[t._v("且它是只读的, 于是当我们指定了滚动条容器的"),a("code",[t._v("height=100%")]),t._v(" 可用高度后, 那么这个"),a("code",[t._v("可视高度")]),t._v("区域就固定了")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[t._v("scrollHeight")]),t._v(" 也是只读属性, 它由容器下的内容决定, 包括由于溢出内容在屏幕上不可见的高度")])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[a("code",[t._v("scrollTop")]),t._v(" , 当容器的内容高度"),a("code",[t._v("scrollHeight")]),t._v(", 大于容器的可视高度"),a("code",[t._v("clientHeight")]),t._v("时出现滚动条\n而滚动条的位置由"),a("code",[t._v("scrollTop")]),t._v(" 来确定, "),a("code",[t._v("1,2")]),t._v(" 属性都是只读, 而"),a("code",[t._v("scrollTop")]),t._v("该属性是可写的")]),t._v(" "),a("p",[t._v("特点：")])])]),t._v(" "),a("ul",[a("li",[t._v("未设置时默认为 0")]),t._v(" "),a("li",[t._v("为负值时不做任何响应")]),t._v(" "),a("li",[t._v("设置为超出本身最大值时，默认为最大值")])]),t._v(" "),a("p",[a("code",[t._v("scrollTop")]),t._v(" 是个"),a("code",[t._v("offset")]),t._v("的概念 , 它表示从哪个位置开始, 把"),a("code",[t._v("内容高度")]),t._v("放到可视区域进行显示")]),t._v(" "),a("p",[t._v("所以顶部的时候")]),t._v(" "),a("p",[a("code",[t._v("scrollTop + clientHeight == clientHeight")]),t._v(" 说明是顶部, scrollTop == 0")]),t._v(" "),a("p",[a("code",[t._v("scrollTop + clientHeight == scrollHeight")]),t._v(" // 底部")]),t._v(" "),a("p",[t._v("滑动到了底部, 内容高度的"),a("code",[t._v("offset")]),t._v(" 被设置的很大, 这个"),a("code",[t._v("offset")]),t._v(" + "),a("code",[t._v("屏幕高度")]),t._v(", 应该等于整个"),a("code",[t._v("内容高度")])]),t._v(" "),a("p",[t._v("滚动条的 top 是小数, 因此判断时需要向上取整")]),t._v(" "),a("p",[a("code",[t._v("Math.ceil(contentArea.scrollTop + contentArea.clientHeight) == contentArea.scrollHeight")]),t._v("\n// 底部时, 返回 true")]),t._v(" "),a("p",[t._v("还有一些其他的 css 高度属性, 都可以不去管, 否则多了不好理解")]),t._v(" "),a("p",[t._v("需要记住的就是"),a("code",[t._v("scrollTop")]),t._v(" , "),a("code",[t._v("clientHeight")]),t._v(", "),a("code",[t._v("scrollHeight")]),t._v(" 即可")]),t._v(" "),a("p",[a("code",[t._v("clientHeight")]),t._v(" 由控件的"),a("code",[t._v("height高度")]),t._v("确定"),a("code",[t._v("可视高度")]),t._v(", 只读\n"),a("code",[t._v("scrollHeight")]),t._v(" 由子元素内容确定"),a("code",[t._v("内容高度")]),t._v(" "),a("code",[t._v("scrollTop")]),t._v(" 内容高度的"),a("code",[t._v("top起始位置")]),t._v("放到可视区域进行显示, 可写")]),t._v(" "),a("h2",{attrs:{id:"底部被覆盖的问题解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#底部被覆盖的问题解决","aria-hidden":"true"}},[t._v("#")]),t._v(" 底部被覆盖的问题解决")]),t._v(" "),a("p",[t._v("当容器内容底部, 比如被按钮栏覆盖遮住的时候, 怎么解决")]),t._v(" "),a("p",[t._v("可能会想到把"),a("code",[t._v("scrollTop")]),t._v(" 设置大一些, 但实际上行不通 "),a("code",[t._v("设置为超出本身最大值时，默认为最大值")])]),t._v(" "),a("p",[t._v("根据前面知识可知 "),a("code",[t._v("scrollTop")]),t._v(" 最大只能设置为 "),a("code",[t._v("scrollHeight - clientHeight")]),t._v(" , 设置超出也不起作用")]),t._v(" "),a("p",[t._v("方法 1 :")]),t._v(" "),a("p",[t._v("从内容入手 , 是在容器的内容区域底部增加空白内容高度 , 但那样的话滚动条似乎能看出来有一截")]),t._v(" "),a("p",[t._v("方法 2:")]),t._v(" "),a("p",[t._v("从可是区域入手, 根本问题其实是可视区域被挡住, 那么我们可以设置"),a("code",[t._v("可视高度")]),t._v(" 不要被挡住即可\n比如上面例子中设置可视高度为可用高度的 "),a("code",[t._v("80%")]),t._v(" , 而不是"),a("code",[t._v("100%")]),t._v(" "),a("code",[t._v("height: 80%;")])]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".mui-content > div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 80%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("overflow-y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h1",{attrs:{id:"滚动条容器内子元素的属性-offsettop"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#滚动条容器内子元素的属性-offsettop","aria-hidden":"true"}},[t._v("#")]),t._v(" 滚动条容器内子元素的属性 offsetTop")]),t._v(" "),a("p",[t._v("父元素内部的所有元素的高度 , 也就是"),a("code",[t._v("内容高度")]),t._v(", 当我们需要让滚动条滚动的时候需要设置 scrollTop")]),t._v(" "),a("p",[t._v("但 scrollTop 设置为多少呢? 于是就需要确定, 每个子元素相对于顶部的位置, 这个属性就是"),a("code",[t._v("offsetTop")])]),t._v(" "),a("p",[t._v("注意, 这个值是容器内子元素的属性 , 每个子元素都有一个 "),a("code",[t._v("offsetTop")])]),t._v(" "),a("p",[t._v("比较常用的做法是, 每个"),a("code",[t._v("子元素")]),t._v("都设置为相同的类, 这样方便选择器进行选择, 然后将他们的"),a("code",[t._v("offsetTop")]),t._v(" 保存到数组里面")]),t._v(" "),a("p",[t._v("这样就方便我们使用, 将 offsetTop 赋值给 scrollTop 进行滚动操作")]),t._v(" "),a("p",[t._v("// 如: 左侧是菜单, 右侧是滚动区域 , 实现点击左侧菜单, 右侧则滚动到对应区域")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 获取子元素的offsetTop, 保存到数组 , 这个数组中的值, 赋值给scrollTop即可滚动到对应位置")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contentItems "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" contentArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelectorAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.content-item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所有子元素dom对象")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contentAreaTops "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义一个数组来保存右边的每个contentItems的offsetTop值, 也就是父容器滚动条对应的scrollTop值。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAreaTops")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    len "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" contentItems"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" len"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    contentAreaTops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" contentItems"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetTop\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAreaTops")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//获取右边的每一个item的offsetTop值")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 添加菜单事件, 点击执行scrollTo")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mui")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#leftBar'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tap'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAttribute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data-index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAttribute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data-index'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//直接让右边的容器的scrollTop = contentAreaTops[i]")]),t._v("\n  contentArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollTop "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" contentAreaTops"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("上面代码就基本实现了, 点击左侧菜单, 右侧则滚动到相应位置, 其中左侧菜单的事件 , 用到委托的概念, 或者说代理模式")]),t._v(" "),a("p",[t._v("就是说, 子元素的事件处理, 并不是直接绑定在子元素上, 而是绑定在父元素上, 比如这里需要处理的是点击的"),a("code",[t._v("a")]),t._v("标签, 但实际事件处理是绑定在"),a("code",[t._v("#leftBar")]),t._v(", 这个就是"),a("code",[t._v("事件委托")])]),t._v(" "),a("p",[a("code",[t._v("https://www.cnblogs.com/owenChen/archive/2013/02/18/2915521.html")]),t._v(" , 这个委托之所以可行, 是因为 dom 的冒泡机制, 使得在父元素上可以捕获到子元素的事件,")]),t._v(" "),a("p",[t._v("且事件的"),a("code",[t._v("target")]),t._v(" 依然是"),a("code",[t._v("a")]),t._v(" , 所以事件处理上可以获取到"),a("code",[t._v("target")]),t._v("相关的属性 , 子元素的事件通过父元素来捕获, 常用来设置同一个父节点下类似的子元素的事件处理")]),t._v(" "),a("h2",{attrs:{id:"获取-offsettop-的时机"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取-offsettop-的时机","aria-hidden":"true"}},[t._v("#")]),t._v(" 获取 offsetTop 的时机")]),t._v(" "),a("p",[t._v("在测试的时候就发现有个问题, 当点击左侧菜单的时候, 右侧的滚动位置不是每次都一样, 有的时候正常, 有的时候会差一点")]),t._v(" "),a("p",[t._v("后来在控制台直接获取"),a("code",[t._v("contentAreaTops")]),t._v(" 这个数组 , 发现值有变化, 按理来说右侧内容区域每个分组相对顶部的"),a("code",[t._v("offsetTop")]),t._v("是固定不变的")]),t._v(" "),a("p",[t._v("但实际测试发现这个值却是有变化的, 原因就是因为页面的加载, 就是说, 如果页面内容加载没有完成, 和页面加载完成所获取的"),a("code",[t._v("offsetTop")]),t._v(" 是不同的")]),t._v(" "),a("p",[t._v("所以, "),a("code",[t._v("offsetTop")]),t._v("错误, 导致滚动条"),a("code",[t._v("scrollTop")]),t._v(" 滚动到错误地方")]),t._v(" "),a("p",[t._v("因此滚动条的滚动必须要放在回调里面, 放在内容加载完毕的回调里面猜呢过去获取 "),a("code",[t._v("子元素的offsetTop")]),t._v(" , 否则就会有不一致的问题")]),t._v(" "),a("p",[t._v("// 见上面代码"),a("code",[t._v("contentAreaTops")]),t._v(" 放的就是"),a("code",[t._v("子元素的offsetTop")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contentAreaTops")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("339")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("683")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1027")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 刷新")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contentAreaTops")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("241")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("387")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("576")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 再次刷新")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contentAreaTops")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("339")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("777")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1121")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("解决方法")]),t._v(" "),a("ol",[a("li",[t._v("每次点击的时候都去初始化计算一次, 容器内部元素的"),a("code",[t._v("offsetTop")])])]),t._v(" "),a("p",[t._v("原始代码中, 初始化位置数组, 获取滚动内部元素的"),a("code",[t._v("offsetTop")]),t._v(" 可能是在页面未渲染完成的时候, 所以每次的值都不一定正确")]),t._v(" "),a("p",[t._v("而当用户点击的时候, 我们都去重新初始化"),a("code",[t._v("contentAreaTops")]),t._v(" 问题基本解决")]),t._v(" "),a("p",[t._v("因为用户不太可能在页面还没有渲染完成的时候就去点菜单, 即使点了菜单, 也会重新计算获取正确位置")]),t._v(" "),a("h2",{attrs:{id:"最后一页的高度不够"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后一页的高度不够","aria-hidden":"true"}},[t._v("#")]),t._v(" 最后一页的高度不够")]),t._v(" "),a("p",[t._v("当最后一页的高度不够的时候, 顶部会显示一部分的倒数第二页的内容 , 即使把这个 scrollTop 设置更大 , 也不行")]),t._v(" "),a("p",[t._v("只能把最后一页的高度调整为合适的高度")]),t._v(" "),a("ol",[a("li",[t._v("判断最后一页的高度是否不够")])]),t._v(" "),a("p",[a("code",[t._v("contentItems[3].clientHeight - contentArea.clientHeight")]),t._v(" 用最后一页的内容的高度 减去 可视高度, 如果是负数说明我们需要对最后一页高度补全")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("直接设置最后一页的高度为可视高度")])]),t._v(" "),a("p",[a("code",[t._v("contentItems[3].style.height = contentArea.clientHeight")])]),t._v(" "),a("h2",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意","aria-hidden":"true"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),a("p",[t._v("内容在滚动的时候, 需要知道具体是对应的哪个菜单项,")]),t._v(" "),a("p",[t._v("判断的时候有两种方法")]),t._v(" "),a("ol",[a("li",[t._v("判断滚动条的位置是否位于, 内容高度范围之间")]),t._v(" "),a("li",[t._v("就是 判断哪个区域的 offsetTop 和滚动条的位置,最接近")])]),t._v(" "),a("p",[t._v("第一种方式会存在误差,比如页面已经在显示最后一个区块, 但是高度不够, 于是屏幕主体已经显示的是最后一个内容块, 但菜单项没有正确设置")]),t._v(" "),a("p",[t._v("以前的解决方法是, 最后一个内容区块如果高度不够那么就手动去设置高度, 左右分屏这个样做是挺正常的")]),t._v(" "),a("p",[t._v("但是有的时候, 这样做就影响了界面 是不能这么做的 , 所以我们可以把判断范围的顶部缩小一下即可")]),t._v(" "),a("p",[t._v("另外如果是 scrollTop 来判断就不存在这个问题")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollBlocksHeights"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" height1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollBlocksHeights"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// current section top")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" height2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollBlocksHeights"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// current section bottom , next section top")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里判断是否是当前区块的时候, 并不需要让scroll的位置完全超过内容的offset ,")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 那样的话, 比如最后的一个内容区域已经在屏幕中显示, 但是因为scroll位置没有超过内容的offset ,")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 于是会导致index 没有正确切换赋值")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以这里改成 scroll顶部和内容的顶部 还差顶部300 个像素就认为, 已经是在显示了下个区块")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("position "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" height1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scrollInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("position "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" height2\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])])])}],!1,null,null,null);s.default=e.exports}}]);