(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{192:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"第二章-eslint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#第二章-eslint","aria-hidden":"true"}},[t._v("#")]),t._v(" 第二章 eslint")]),t._v(" "),e("h2",{attrs:{id:"_2-4-eslint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-eslint","aria-hidden":"true"}},[t._v("#")]),t._v(" 2-4 eslint")]),t._v(" "),e("h3",{attrs:{id:"eslint-基础"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eslint-基础","aria-hidden":"true"}},[t._v("#")]),t._v(" eslint 基础")]),t._v(" "),e("p",[e("a",{attrs:{href:"%22http://www.cnblogs.com/yzg1/p/6282791.html%22"}},[t._v("eslint 规则")])]),t._v(" "),e("p",[t._v("eslint 官方提供了 3 种预安装包: eslint-config-google, eslint-config-airbnb, eslint-config-standard")]),t._v(" "),e("p",[t._v("如果是 standard 配置的话 参考"),e("code",[t._v("https://www.npmjs.com/package/eslint-config-standard")])]),t._v(" "),e("p",[t._v("安装 eslint "),e("code",[t._v("npm install eslint --save-dev")])]),t._v(" "),e("p",[t._v("手动模式使用 standard-config, 安装依赖包")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("npm install "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev \\\n    eslint"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("config"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("standard \\\n    eslint"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("standard \\\n    eslint"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("promise \\\n    eslint"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" \\\n    eslint"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("node\n")])])]),e("p",[t._v("添加 eslint 对 vue 的支持")]),t._v(" "),e("p",[t._v("npm install -D eslint-plugin-html")]),t._v(" "),e("p",[t._v("// .eslintrc")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"extends"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"standard"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugins"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"html"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"配置-package-json-使用命令-eslint-和修复"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置-package-json-使用命令-eslint-和修复","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置 package.json 使用命令 eslint 和修复")]),t._v(" "),e("p",[t._v("修改 package.json 定义命令执行 lint 检查, 和 lint --fix 自动修复错误")]),t._v(" "),e("p",[t._v("// package.json")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lint"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --ext .js --ext .jsx --ext .vue client/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lint-fix"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --fix --ext .js --ext .jsx --ext .vue client/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),e("p",[t._v("但这只是用 npm run lint 或 npm run lint-fix 就能调用 eslint ,")]),t._v(" "),e("p",[t._v("但如果不手动调用的话, webpack 在打包的时候是不会使用 eslint 检查代码的")]),t._v(" "),e("h3",{attrs:{id:"配置-webpack-的-eslint"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置-webpack-的-eslint","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置 webpack 的 eslint")]),t._v(" "),e("p",[e("code",[t._v("npm install eslint-loader babel-eslint")])]),t._v(" "),e("p",[t._v("修改 eslint 配置文件 , 项目代码都是会被 babel 处理 , webpack 使用 eslint-loader")]),t._v(" "),e("p",[t._v("如果不设置 parser 为 babel-eslint 那么会有一些问题")]),t._v(" "),e("p",[t._v("// .eslintrc")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extends"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"standard"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"plugins"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"html"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"parser"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-eslint"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("// "),e("code",[t._v("webpack.config.js")])]),t._v(" "),e("p",[t._v("定义在 vue-loader 之前使用 eslint 预处理, enforce: 'pre' , post 指的就是"),e("code",[t._v("之后")]),t._v("再处理")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("    rules"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/\\.(vue|js|jsx)$/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        loader"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eslint-loader'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        exclude"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/node_modules/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        enforce"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pre'")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/\\.vue$/")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        loader"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-loader'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        options"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createVueLoaderOptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isDev"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),e("h3",{attrs:{id:"使用-editorconfig-插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-editorconfig-插件","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用 editorconfig 插件")]),t._v(" "),e("p",[t._v("不同的编辑器有不同风格, 可以通过使用 editorconfig 插件让编辑器代码风格一致")]),t._v(" "),e("p",[e("code",[t._v("http://www.cnblogs.com/xiyangbaixue/p/4201490.html")])]),t._v(" "),e("p",[e("code",[t._v("editorconfig")]),t._v(" 会自动根据规则来修复代码风格, 比如加上空行等")]),t._v(" "),e("h3",{attrs:{id:"使用-husky-来规范-git-提交前-lint-代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-husky-来规范-git-提交前-lint-代码","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用 husky 来规范 git 提交前 lint 代码")]),t._v(" "),e("p",[e("code",[t._v("https://www.jianshu.com/p/f0d31f92bfab")])]),t._v(" "),e("p",[t._v("需要先初始化仓库, 安装 husky , 它是 git 的钩子工具, 当运行 git commit 的时候会先调用我们定义的命令")]),t._v(" "),e("p",[t._v("// package.json")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lint"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --ext .js --ext .jsx --ext .vue client/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lint-fix"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --fix --ext .js --ext .jsx --ext .vue client/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"precommit"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm run lint-fix"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),e("p",[t._v("这样当运行 git commit 的时候, 真正提交之前会 , husky 会帮我们先调用 "),e("code",[t._v("npm run precommit")])]),t._v(" "),e("p",[t._v("也就是 "),e("code",[t._v("npm run lint-fix")]),t._v(" 来 lint-fix 代码, 这样就能强制规范代码后提交代码")]),t._v(" "),e("h2",{attrs:{id:"eslint-和-prettier-结合-vscode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eslint-和-prettier-结合-vscode","aria-hidden":"true"}},[t._v("#")]),t._v(" eslint 和 prettier 结合 vscode")]),t._v(" "),e("p",[e("code",[t._v("https://egoist.moe/2017/12/11/write-better-code-with-eslint-and-prettier/")])]),t._v(" "),e("p",[t._v("而 vscode 插件 prettier 默认安装了 prettier-eslint 插件, 而且 vscode 的 prettier 插件会在")]),t._v(" "),e("p",[e("code",[t._v("editor.formatOnSave")]),t._v(" 开启的话, 自动调用 prettier,")]),t._v(" "),e("p",[t._v("而且 prettier 默认是读取自己的配置文件, 比如"),e("code",[t._v(".prettierrc")]),t._v(", "),e("code",[t._v(".prettierrc")]),t._v(" 等")]),t._v(" "),e("p",[t._v("如果不存在 prettier 配置文件, 那么它会读取 "),e("code",[t._v("editorconfig")]),t._v(" 的配置文件 "),e("code",[t._v(".editorconfig")]),t._v("和 vscode 的 prettier 配置")]),t._v(" "),e("p",[t._v("如果需要使用 prettier-eslint 格式化, 而不是 prettier 的规则去格式化代码,")]),t._v(" "),e("p",[t._v("则需要在 vscode 中设置 "),e("code",[t._v('"prettier.autofix on save": true,')])]),t._v(" "),e("p",[t._v("但需要注意的是 prettier-eslint 并不是说按 eslint 去格式化代码")]),t._v(" "),e("p",[t._v("prettier-eslint 只是 "),e("code",[t._v("Formats your JavaScript using prettier followed by eslint --fix")])]),t._v(" "),e("p",[t._v("也就是说启用 vscode 的 eslint 插件也有个选项是 "),e("code",[t._v("autofix on save")]),t._v("的话, 它最终还是要按 prettier 规则去格式化代码")]),t._v(" "),e("p",[t._v("如果最终需要 prettier 格式化代码")]),t._v(" "),e("p",[t._v("那么开启 "),e("code",[t._v("prettier.eslintIntegration")]),t._v(" 和 "),e("code",[t._v("editor.formatOnSave")]),t._v(" 则可以实现最终代码一定是 prettier 风格格式")]),t._v(" "),e("p",[t._v("如果最终需要是 eslint 格式的话 , 那么完全可以不安装 prettier")]),t._v(" "),e("p",[t._v("vscode 的 eslint 插件也有个选项是 "),e("code",[t._v("autofix on save")]),t._v(" 开启这个选项即可")]),t._v(" "),e("h2",{attrs:{id:"prettier"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prettier","aria-hidden":"true"}},[t._v("#")]),t._v(" prettier")]),t._v(" "),e("p",[e("code",[t._v("https://egoist.moe/2017/12/11/write-better-code-with-eslint-and-prettier/")]),t._v(" "),e("code",[t._v("https://nice.lovejade.cn/zh/article/beautify-vue-by-eslint-and-prettier.html#%E6%B7%BB%E5%8A%A0%E7%BC%96%E8%BE%91%E5%99%A8%E9%85%8D%E7%BD%AE")]),t._v(" "),e("code",[t._v("https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode")])]),t._v(" "),e("p",[t._v("eslint-plugin-prettier does not install Prettier or ESLint for you. You must install these yourself.")]),t._v(" "),e("p",[t._v("npm install --save-dev eslint-plugin-prettier\nnpm install --save-dev --save-exact prettier")]),t._v(" "),e("p",[t._v("Then, in your .eslintrc.json:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"plugins"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"prettier"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rules"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"prettier/prettier"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}],!1,null,null,null);s.default=n.exports}}]);